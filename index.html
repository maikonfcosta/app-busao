<!doctype html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Calculadora ‚Äì Bus√£o (v4.0)</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="wrap">
  <div class="panel" id="leftPanel">
    <header><h1>Bus√£o ‚Äì Calculadora</h1></header>

    <div class="tabs-top">
      <button class="tabbtn act" data-tab="tab-config">Configura√ß√£o</button>
      <button class="tabbtn" data-tab="tab-seats">Assentos</button>
      <button class="tabbtn" data-tab="tab-catalog">Cat√°logo</button>
      <button class="tabbtn" data-tab="tab-regrasfaq">Regras & FAQ</button>
    </div>

    <div class="tabview act" id="tab-config">
      <div class="section">
        <label>Jogador</label>
        <input id="playerName" placeholder="Nome do jogador" />
      </div>

      <div class="section">
        <label>Motorista</label>
        <select id="driver"></select>
        <div id="driverInfo" class="drivers" style="margin-top:10px"></div>
        <div class="inline">
          <input type="checkbox" id="expCobradores" />
          <label for="expCobradores" style="margin:0">Ativar Expans√£o COBRADORES üí∂</label>
        </div>
        <div class="inline">
          <input type="checkbox" id="expApaixonados" />
          <label for="expApaixonados" style="margin:0">Ativar Expans√£o: Os Apaixonados üíò</label>
        </div>
        <div class="inline">
          <input type="checkbox" id="expPerrengues" />
          <label for="expPerrengues" style="margin:0">Ativar Expans√£o: Perrengues ‚ö†Ô∏è</label>
        </div>
        <div class="inline">
          <input type="checkbox" id="expEstouNoBusao" />
          <label for="expEstouNoBusao" style="margin:0">Ativar Expans√£o: Estou no bus√£o üëç</label>
        </div>
        <div class="inline">
          <input type="checkbox" id="expLendasUrbanas" />
          <label for="expLendasUrbanas" style="margin:0">Ativar Expans√£o: Lendas Urbanas üëª</label>
        </div>
        <div class="inline">
          <input type="checkbox" id="expGrupoPagode" />
          <label for="expGrupoPagode" style="margin:0">Ativar Expans√£o: Grupo de Pagode üéµ</label>
        </div>
        <div class="inline">
          <input type="checkbox" id="expRotasDiarias" />
          <label for="expRotasDiarias" style="margin:0">Ativar Expans√£o: Rotas Di√°rias üöå</label>
        </div>
      </div>

      <div class="section">
        <label>Melhorias do Bus√£o (at√© 3, sem repetir)</label>
        <div id="improvButtons" class="bar" style="flex-wrap:wrap"></div>
        <div id="improvInfo" class="drivers" style="margin-top:10px"></div>
        <div class="chips" style="margin-top:8px">
          <span class="chip">Dona Fausta no bus√£o ‚Üí melhorias n√£o pontuam.</span>
          <span class="chip">Apaixonados (2+ adjacentes) ‚Üí dobro da soma dos pontos base do grupo.</span>
        </div>
      </div>

      <div class="section" id="perrenguesSection" style="display:none;">
        <label>Perrengues (sem limite)</label>
        <div id="perrenguesButtons" class="bar" style="flex-wrap:wrap"></div>
        <div id="perrenguesInfo" class="drivers" style="margin-top:10px"></div>
      </div>

      <div class="section" id="rotasDiariasSection" style="display:none;">
        <label>Rotas Di√°rias (sem limite)</label>
        <div id="rotasDiariasButtons" class="bar" style="flex-wrap:wrap"></div>
        <div id="rotasDiariasInfo" class="drivers" style="margin-top:10px"></div>
      </div>

      <div class="section">
        <label>Cartas na m√£o (‚Äì1 cada)</label>
        <input id="handCount" type="number" min="0" step="1" value="0" />
      </div>
    </div>

    <div class="tabview" id="tab-seats">
      <div class="section">
        <div class="section-title">
          <span>Selecione o Assento</span>
          <button id="btnVisualHelp" class="btn ghost sm" title="Ajuda de adjac√™ncia">?</button>
        </div>
        <div class="section-sub">Clique no assento correspondente e escolha o personagem, o calculo √© automatizado ap√≥s escolher os assentos v√°lidos..</div>
        <div id="visualHelp" class="popover">
          <b>Adjac√™ncia:</b> esquerda/direita, cima/baixo, diagonais. Ex.: Assento 3 ‚Üí adjacentes: 2, 4, 8, 9, 10.
        </div>

        <div id="busVisual" class="bus-visual">
          <div class="driver"><div class="label">motorista</div></div>
          <div class="wheel w1"></div><div class="wheel w2"></div>
          <div class="seats" id="busVisualSeats"></div>
        </div>
      </div>

      <div class="grid" id="grid"></div>
      <div class="section"><div class="chips"><span class="chip">Adjac√™ncias v√°lidas ‚Äì ortogonais e diagonais</span></div></div>

      <div class="section">
        <label>A√ß√µes</label>
        <div class="bar">
          <button class="btn acc" id="btnClearSeats">Limpar assentos</button>
          <button class="btn ghost" id="btnNewRound">Nova pontua√ß√£o</button>
        </div>
      </div>

      <div class="section">
        <label>Salvar no Ranking</label>
        <div class="bar" style="margin-bottom:8px">
          <button class="btn accent" id="btnSaveScore">Salvar pontua√ß√£o</button>
          <button class="btn warn" id="btnResetRanking">Zerar ranking</button>
        </div>
        <div class="muted">Pontua√ß√µes salvas no seu navegador (localStorage).</div>
      </div>
    </div>

    <div class="tabview" id="tab-catalog">
      <div class="section">
        <div class="section-title"><span>Cat√°logo de Cartas</span></div>
        <div class="catalog">
          <div class="cat-controls">
            <input id="catalogSearch" placeholder="Busque por nome, tag ou palavra do efeito (ex.: Jovem, Tranquilo, Wi-Fi...)" />
            <button class="btn sm" id="clearCatalogSearch">Limpar</button>
            <div class="chips">
              <span class="chip">Dica: inclui Passageiros, Cobradores, Motoristas e Melhorias</span>
            </div>
          </div>
          <div id="catalogContent"></div>
        </div>
      </div>
    </div>

    <div class="tabview" id="tab-regrasfaq">
        <div class="section">
            <div class="section-title"><span>Regras & FAQ</span></div>
            <div class="tabs" style="display:flex;border-bottom:1px solid var(--line)">
                <div class="itab act" data-itab="regras" style="padding:10px 14px;cursor:pointer;color:#60a5fa;border-bottom:2px solid #60a5fa">Regras (online)</div>
                <div class="itab" data-itab="faq" style="padding:10px 14px;cursor:pointer;color:#cbd5e1;border-bottom:2px solid transparent">FAQ & Contato</div>
            </div>
        </div>
        <div class="rules-container">
            <h1>Regras do Bus√£o</h1>
            <p>Jogo de estrat√©gia e equil√≠brio para 2 a 6 jogadores</p>
            
            <div class="quick-summary">
                <p><b>Resumo R√°pido</b></p>
                <ul>
                    <li><b>Objetivo:</b> Somar pontos com passageiros + motorista + melhorias.</li>
                    <li><b>Fim do jogo:</b> Fim da Linha, Bus√£o lotado ou fim das cartas da rua.</li>
                    <li><b>Pontua√ß√£o:</b> Passageiros (efeitos), motorista (+1 por tags), melhorias (+1 por tags) e ‚Äì1 por carta na m√£o.</li>
                    <li><b>Apaixonados:</b> Podem repetir; se 2+ estiverem adjacentes formam um grupo que <b>dobra</b> a soma dos <b>pontos base</b> do grupo.</li>
                    <li><b>Grupo de Pagode:</b> Se reunir os 5 integrantes, ganha 50 pontos extras!</li>
                </ul>
            </div>
        
            <details class="rule-section" open>
                <summary><h2>Introdu√ß√£o</h2></summary>
                <div class="rule-content-body">
                    <p>Bus√£o √© um jogo de estrat√©gia e equilibro para 2 a 6 jogadores, onde voc√™ assume o volante de um √¥nibus lotado, com a miss√£o de controlar o embarque e desembarque de passageiros, garantindo conforto e evitando caos a bordo.</p>
                    <p>A cada rodada, voc√™ pode tentar resolver imprevistos para manter a harmonia entre os passageiros que s√£o t√£o diferentes entre si. Afinal, ningu√©m gosta de sentar-se ao lado de algu√©m indesejado.</p>
                    <p>Use suas cartas com intelig√™ncia, tome decis√µes r√°pidas e garanta o maior n√∫mero poss√≠vel de pontos com suas a√ß√µes. O Bus√£o est√° nas suas m√£os e a paz nessa viagem tamb√©m!</p>
                </div>
            </details>
            
            <details class="rule-section">
                <summary><h2>Expans√µes</h2></summary>
                <div class="rule-content-body">
                    <p><b>Estou no Bus√£o:</b> Passageiros especiais com habilidades √∫nicas.</p>
                    <p><b>Lendas Urbanas:</b> Personagens m√≠sticos com efeitos poderosos.</p>
                    <p><b>Grupo de Pagode:</b> 5 integrantes especiais - re√∫na todos para ganhar 50 pontos extras!</p>
                    <p><b>Rotas Di√°rias:</b> Cartas de b√¥nus que d√£o pontos extras por condi√ß√µes espec√≠ficas.</p>
                    <p><b>Perrengues:</b> Eventos desafiadores que afetam todos os jogadores.</p>
                </div>
            </details>
        </div>
        <div class="tabpan" id="itab-faq" style="display: none; padding: 12px;">
          <p><b>Perguntas frequentes</b></p>
          <details><summary>Como funciona a adjac√™ncia?</summary><div class="muted">Esquerda/direita + 3 da outra fileira (motorista n√£o conta).</div></details>
          <details><summary>‚ÄúEntre ele e o motorista‚Äù (Motolover)</summary><div class="muted">Conta todos nas colunas √† esquerda (duas fileiras).</div></details>
          <details><summary>Cartas na m√£o descontam?</summary><div class="muted">Sim, ‚Äì1 por carta restante (exceto se Isabel estiver no bus√£o).</div></details>
          <details><summary>Como funciona a expans√£o dos Apaixonados?</summary><div class="muted">Podem ser duplicados. Se 2+ estiverem adjacentes, dobram a soma dos pontos base do grupo.</div></details>
          <details><summary>Como funciona o Grupo de Pagode?</summary><div class="muted">Se reunir os 5 integrantes, ganha 50 pontos extras al√©m das pontua√ß√µes normais.</div></details>
          <p style="margin-top:10px">Contato: <a href="mailto:contato@busao.game">contato@busao.game</a></p>
        </div>
    </div>
  </div>

  <div class="panel">
    <header><h1>Resultado</h1><small id="playerTag"></small></header>
    <div class="section totals">
      <div class="total"><h3>Total</h3><div id="totalScore" class="v kpi neu">0</div></div>
      <div class="total"><h3>Quebra</h3>
        <div class="muted">Passageiros: <b id="sumPassengers">0</b></div>
        <div class="muted">Motorista: <b id="sumDriver">0</b></div>
        <div class="muted">Melhorias: <b id="sumImprov">0</b></div>
        <div class="muted">Perrengues: <b id="sumPerrengues">0</b></div>
        <div class="muted">Rotas Di√°rias: <b id="sumRotasDiarias">0</b></div>
        <div class="muted">M√£o: <b id="sumHand">0</b></div>
      </div>
    </div>
    <div class="section" style="padding-top:8px"><label>Explica√ß√£o por assento</label><div id="warnings" class="muted" style="margin-top:6px"></div><div id="explain" class="explain"></div></div>
    <div class="section">
      <label>Ranking</label>
      <div class="table-wrap">
        <table id="rankTable"><thead><tr><th>#</th><th>Jogador</th><th>Motorista</th><th>Melhorias</th><th class="right">Pontua√ß√£o</th></tr></thead><tbody></tbody></table>
      </div>
    </div>
    <div class="foot">Motorista e melhorias: +1 por ocorr√™ncia das subcategorias descritas. Cartas sem exig√™ncia de embarque sempre contam para eles.</div>
  </div>
</div>

<div id="pickerModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="pickerTitle">
  <div class="modal-card">
    <div class="modal-head">
      <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
        <strong id="pickerTitle">Escolher carta para o assento</strong>
        <span id="pickerSeatLabel" class="chip"></span>
      </div>
      <div class="bar">
        <button id="pickerClear" class="btn sm">Limpar assento</button>
        <button id="pickerClose" class="btn ghost sm">Fechar</button>
      </div>
    </div>
    <div class="modal-body">
      <div class="picker-filter">
        <input id="pickerSearch" placeholder="Buscar por nome/tag/efeito..." />
        <button class="pill act" data-tab="pass">Passageiros</button>
        <button class="pill" data-tab="cob">Cobradores</button>
        <button class="pill" data-tab="apx">Apaixonados</button>
        <button class="pill" data-tab="estou">Estou no Bus√£o</button>
        <button class="pill" data-tab="lendas">Lendas Urbanas</button>
        <button class="pill" data-tab="pagode">Grupo de Pagode</button>
      </div>
      <div id="pickerGrid" class="picker-grid"></div>
    </div>
  </div>
</div>

<script src="js/script.js"></script>
<script src="js/main.js"></script>
</body>
</html>